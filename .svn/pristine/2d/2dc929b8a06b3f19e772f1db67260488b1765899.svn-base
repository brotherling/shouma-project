webpackJsonp([2],{"0X4O":function(e,t){},"6rPw":function(e,t,a){"use strict";(function(e){var i=a("4YfN"),s=a.n(i),l=a("COCy");window.submifile=[],t.a={name:"assetAdd",components:{builder:l.a},data:function(){return{parentMsg:"资产新增",AssetData:[],formSubmit:{},submitFile:[],Img:{data:"",dataname:""},FileData:[],filedata:[],filedataName:[],showfile:"",ValidationData:[],imageUrl:e.resUrl+"/Resources/images/nopicture.jpg",assetId:""}},computed:s()({},Vuex.mapState(["assetadd"])),watch:{},beforeRouteEnter:function(e,t,a){a(function(a){"supplier"==t.name?(a.formSubmit.providerName=t.query.supplierName,a.formSubmit.selectProviderId=t.query.supplierId,a.setVuex(a.formSubmit)):"personnel"==t.name?(a.formSubmit.useDeptId=t.query.data.userDeptId,a.formSubmit.useDeptName=t.query.data.userDeptName,a.formSubmit.useUserId=t.query.data.userId,a.formSubmit.useUserName=t.query.data.userName,a.setVuex(a.formSubmit)):"department"==t.name?(a.formSubmit.useDeptId=t.query.useDeptId,a.formSubmit.useDeptName=t.query.useDeptName,a.setVuex(a.formSubmit)):"admindepartment"==t.name?(a.formSubmit.adminDeptId=t.query.useDeptId,a.formSubmit.adminDeptName=t.query.useDeptName,a.setVuex(a.formSubmit)):"assetClass"==t.name?(a.formSubmit.categoryId=t.query.categoryId,a.formSubmit.categoryName=t.query.categoryName,a.setVuex(a.formSubmit)):"designated"==t.name?(a.formSubmit.adressId=t.query.adressId,a.formSubmit.addressName=t.query.addressName,a.setVuex(a.formSubmit)):"homemenu"==t.name?(a.assetId="",a.getdata(),a.reseat(0),$("#vertical").show(),$("#reset").show()):"assetEdit"==t.name&&(a.assetId=e.query.id[0],$("#vertical").hide(),$("#reset").hide(),a.getdata(),a.reseat(0))})},methods:s()({},Vuex.mapActions({assignment:"setAssetdate"}),{acceptImg:function(e){var t=e,a=this,i=t.files[0],s=t.files[0].type,l=(t.files[0].size/1024/1024).toFixed("3"),o=new FileReader;o.onload=function(e){compress(e.target.result,l,function(e){a.imageUrl=e,a.Img.data=e.replace("data:"+s+";base64,",""),a.Img.dataname=s})},o.readAsDataURL(i)},acceptFile:function(e){console.log(e),this.FileData=e;var t=this;t.filedataName=[],this.FileData.forEach(function(e,a){var i=e.name;t.filedataName.push(i);var s=new FileReader;s.readAsDataURL(e),s.onload=function(){var a=s.result.replace("data:"+e.type+";base64,","");t.filedata.push(a)}}),this.showfile=this.filedataName.join(","),console.log(this.filedataName),$("#fileshow").html(this.showfile)},reseat:function(t){var a=$("#Setfile");a.after(a.clone()),a.remove(),submifile=[],this.filedataName=[],this.filedata=[],this.showfile="",$("#fileshow").html(this.showfile),this.imageUrl=e.resUrl+"/Resources/images/nopicture.jpg",this.Img={data:"",dataname:""},0!=t&&this.getsubmitData()},submit:function(){var e=this;this.$http.post("/API/assetservice/SaveAsset",{"":{obj:this.formSubmit,mainAstId:"",Img:this.Img}},{emulateJSON:!0}).then(function(t){e.submitfile(t.data.resultNum)})},submitValidation:function(){for(var e=0,t=this.ValidationData,a=0;a<t.length;a++){var i=t[a];""!=this.formSubmit[i]&&e++}e==t.length?this.submit():this.$alert("请输入红色的必填项","提示",{confirmButtonText:"确定",callback:function(e){}})},submitfile:function(e){var t=this;this.$http.post("/API/assetservice/SaveFile",{"":{filedata:this.filedata,filedataName:this.filedataName,assetId:e}},{emulateJSON:!0}).then(function(e){t.$alert(e.data.resultMsg,"提示",{confirmButtonText:"确定",callback:function(e){}})})},getdata:function(){var e=this;this.$http.get("/API/assetservice/GetAssetPage",{parmas:{assetId:this.assetId}},{emulateJSON:!0}).then(function(t){e.AssetData=t.data,e.getValidationData(t.data),""==e.assetId?e.getsubmitData():e.GetAssetDetail()})},getsubmitData:function(){var e=this;this.$http.get("/API/assetservice/GetAddField",{emulateJSON:!0}).then(function(t){e.formSubmit=t.data,e.setVuex(vm.formSubmit)})},GetAssetDetail:function(){var t=this;this.$http.get("/API/assetservice/GetAssetDetail",{params:{assetId:this.assetId}},{emulateJSON:!0}).then(function(a){console.log(a.data),t.formSubmit=a.data.obj,null!=a.data.Img&&(t.imageUrl=e.resUrl+a.data.Img),t.showfile=a.data.File.fileName.join(","),$("#fileshow").html(t.showfile),t.setVuex(vm.formSubmit)})},setVuex:function(e){this.assignment(e)},getValidationData:function(e){for(var t in this.ValidationData=[],e)e[t].forEach(function(e){1==e.isNull&&this.ValidationData.push(e.tableName)},this)}}),mounted:function(){}}}).call(t,a("9AUj"))},COCy:function(e,t,a){"use strict";var i={name:"builder",props:{AssetData:"",assetadd:"",formSubmit:"",filedataName:"",imageUrl:"",assetId:""},data:function(){return{show3:!1,picked:"",datetime4:"2017-05-11",show:!0,options:["asb","ddd"],grouping:[],scroll:"0",groupedData:[],validNumber:function(e){return{valid:/^(?:[1-9]\d*|0)(?:\.\d+)?$|^(?:\.0|0\.)$/.test(e),msg:"请输入数字"}}}},activated:function(){document.getElementById("setscroll").scrollTop=this.scroll},watch:{pokerHistory:function(e,t){var a=this;""!=e?(this.$http.get("/API/assetservice/RefreshPageField",{params:{categoryId:e}},{emulateJSON:!0}).then(function(e){a.groupedData=e.data}),this.$http.get("/API/assetservice/RefreshPageFieldGroup",{params:{categoryId:e}},{emulateJSON:!0}).then(function(e){a.grouping=e.data})):this.getdata()}},computed:{pokerHistory:function(){return this.formSubmit.categoryId}},methods:{numberChange:function(e,t){/^(?:[1-9]\d*|0)(?:\.\d+)?$|^(?:\.0|0\.)$/.test(e)||(this.formSubmit[t]="")},imgchange:function(e){var t=e.target;this.$emit("accept",t)},subPic:function(){this.$refs.subimg.click()},openfile:function(){this.$refs.file.click()},fileChange:function(e){var t=e.target.files[0];submifile.push(t),console.log(submifile),this.$emit("acceptfile",submifile)},linkDepartment:function(){console.log(this.formSubmit),""==this.formSubmit.useUserId&&this.$router.push({path:"/department"})},Deselectpage:function(){console.log(this.formSubmit);for(var e=0,t=this.$refs.c1;e<t.length;e++)this.$refs.c1[e].hide()},getdata:function(){var e=this;this.groupedData=this.AssetData,this.$http.get("/API/assetservice/GetGroupByAssetId",{emulateJSON:!0}).then(function(t){e.grouping=t.data})},setscroll:function(e){var t=e.target;this.scroll=t.scrollTop}},mounted:function(){this.getdata()}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"80%","overflow-y":"auto"},attrs:{id:"setscroll"},on:{scroll:function(t){e.setscroll(t)}}},[a("div",{staticClass:"assetAddConetent"},[a("div",{staticClass:"profittop"},[e._v("基本信息")]),e._v(" "),a("div",{staticClass:"setform"},[a("group",[e._l(e.AssetData.immobilization,function(t){return a("div",{key:t.id},["customer"==t.formType?a("x-input",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,title:t.displayName,placeholder:t.placeHolder},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[immobilization.tableName]"}}):e._e(),e._v(" "),"PositiveInteger"==t.formType?a("x-input",{ref:"number",refInFor:!0,class:1==t.isNull?"red":"",attrs:{"is-type":e.validNumber,disabled:0==t.enabled,type:"text",title:t.displayName,placeholder:t.placeHolder},on:{"on-blur":function(a){e.numberChange(e.formSubmit[t.tableName],t.tableName)}},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[immobilization.tableName]"}}):e._e(),e._v(" "),"serverNumber"==t.formType?a("x-input",{ref:"number",refInFor:!0,class:1==t.isNull?"red":"",attrs:{"is-type":e.validNumber,disabled:0==t.enabled,type:"text",title:t.displayName,placeholder:t.placeHolder},on:{"on-blur":function(a){e.numberChange(e.formSubmit[t.tableName],t.tableName)}},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[immobilization.tableName]"}}):e._e(),e._v(" "),"planTime"==t.formType?a("datetime",{class:1==t.isNull?"red":"",attrs:{readonly:0==t.enabled,title:t.displayName,placeholder:t.placeHolder},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[immobilization.tableName]"}}):e._e(),e._v(" "),"serviceSelect"==t.formType?a("popup-radio",{ref:"c1",refInFor:!0,class:1==t.isNull?"red":"",attrs:{readonly:0==t.enabled,title:t.displayName,placeholder:t.placeHolder,options:t.field_optionswx.options},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[immobilization.tableName]"}},[a("p",{staticClass:"vux-1px-b select_class",attrs:{slot:"popup-header"},on:{click:function(t){e.Deselectpage()}},slot:"popup-header"},[e._v("取消")])]):e._e(),e._v(" "),"description"==t.formType?a("x-textarea",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,title:t.displayName,placeholder:t.placeHolder},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[immobilization.tableName]"}}):e._e(),e._v(" "),"text"==t.formType?a("x-input",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,title:t.displayName,placeholder:t.placeHolder},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[immobilization.tableName]"}}):e._e(),e._v(" "),"number"==t.formType?a("x-input",{ref:"number",refInFor:!0,class:1==t.isNull?"red":"",attrs:{"is-type":e.validNumber,value:e.formSubmit[t.tableName],disabled:0==t.enabled,type:"text",title:t.displayName,placeholder:t.placeHolder},on:{"on-blur":function(a){e.numberChange(e.formSubmit[t.tableName],t.tableName)}},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[immobilization.tableName]"}}):e._e(),e._v(" "),"datetime"==t.formType?a("datetime",{class:1==t.isNull?"red":"",attrs:{readonly:0==t.enabled,title:t.displayName,placeholder:t.placeHolder},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[immobilization.tableName]"}}):e._e(),e._v(" "),"select"==t.formType?a("popup-radio",{ref:"c1",refInFor:!0,class:1==t.isNull?"red":"",attrs:{readonly:0==t.enabled,title:t.displayName,placeholder:t.placeHolder,options:t.field_optionswx.options},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[immobilization.tableName]"}},[a("p",{staticClass:"vux-1px-b select_class",attrs:{slot:"popup-header"},on:{click:function(t){e.Deselectpage()}},slot:"popup-header"},[e._v("取消")])]):e._e(),e._v(" "),"textarea"==t.formType?a("x-textarea",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,title:t.displayName,placeholder:t.placeHolder},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[immobilization.tableName]"}}):e._e(),e._v(" "),"selectProviderId"==t.formType?a("cell",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,title:t.displayName,placeholder:t.placeHolder,value:e.formSubmit.providerName,link:"/supplier"},model:{value:e.formSubmit.providerName,callback:function(t){e.$set(e.formSubmit,"providerName",t)},expression:"formSubmit.providerName"}}):e._e(),e._v(" "),"useUserId"==t.formType?a("cell",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,title:t.displayName,placeholder:t.placeHolder,value:e.formSubmit.useUserName,link:"/personnel"},model:{value:e.formSubmit.useUserName,callback:function(t){e.$set(e.formSubmit,"useUserName",t)},expression:"formSubmit.useUserName"}}):e._e(),e._v(" "),"useDeptId"==t.formType?a("cell",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,title:t.displayName,placeholder:t.placeHolder,value:e.formSubmit.useDeptName},nativeOn:{click:function(t){e.linkDepartment()}},model:{value:e.formSubmit.useDeptName,callback:function(t){e.$set(e.formSubmit,"useDeptName",t)},expression:"formSubmit.useDeptName"}}):e._e(),e._v(" "),"categoryId"==t.formType?a("cell",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,title:t.displayName,placeholder:t.placeHolder,value:e.formSubmit.categoryName,link:"/assetClass"},model:{value:e.formSubmit.categoryName,callback:function(t){e.$set(e.formSubmit,"categoryName",t)},expression:"formSubmit.categoryName"}}):e._e(),e._v(" "),"adminDeptId"==t.formType?a("cell",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,title:t.displayName,placeholder:t.placeHolder,value:e.formSubmit.adminDeptName,link:"/admindepartment"},model:{value:e.formSubmit.adminDeptName,callback:function(t){e.$set(e.formSubmit,"adminDeptName",t)},expression:"formSubmit.adminDeptName"}}):e._e(),e._v(" "),"selectAdressId"==t.formType?a("cell",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,title:t.displayName,placeholder:t.placeHolder,value:e.formSubmit.addressName,link:"/designated"},model:{value:e.formSubmit.addressName,callback:function(t){e.$set(e.formSubmit,"addressName",t)},expression:"formSubmit.addressName"}}):e._e()],1)}),e._v(" "),a("cell",{attrs:{title:"附件"},nativeOn:{click:function(t){e.openfile()}}},[a("input",{ref:"file",staticStyle:{display:"none"},attrs:{type:"file",id:"Setfile",multiple:"multiple"},on:{change:function(t){e.fileChange(t)}}}),e._v(" "),a("i",{staticClass:"fa fa-file"}),e._v(" "),a("span",{attrs:{id:"fileshow"}}),e._v(" "),a("svg",{staticClass:"vux-x-icon vux-x-icon-ios-plus-empty",staticStyle:{color:"#3F82DE"},attrs:{type:"ios-plus-empty",size:"20",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 512 512"}},[a("path",{attrs:{d:"M384 265H264v119h-17V265H128v-17h119V128h17v120h120v17z"}})])]),e._v(" "),a("cell",{attrs:{title:"图片"}},[a("div",{staticClass:"avatar-uploader",on:{click:function(t){e.subPic()}}},[a("div",{staticClass:"el-upload el-upload--text",attrs:{tabindex:"0"}},[a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}),e._v(" "),a("input",{ref:"subimg",staticClass:"el-upload__input",attrs:{accept:"image/*",type:"file",name:"file"},on:{change:function(t){e.imgchange(t)}}})])])])],2)],1),e._v(" "),e._l(e.grouping,function(t){return a("div",{key:t.id},[a("div",{staticClass:"profittop"},[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"setform"},[a("group",e._l(e.groupedData[t.id],function(t){return a("div",{key:t.id},["select"==t.formType?a("popup-radio",{ref:"c1",refInFor:!0,class:1==t.isNull?"red":"",attrs:{readonly:0==t.enabled,title:t.displayName,placeholder:t.placeHolder,options:t.field_optionswx.options},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[groupcont.tableName]"}},[a("p",{staticClass:"vux-1px-b select_class",attrs:{slot:"popup-header"},on:{click:function(t){e.Deselectpage()}},slot:"popup-header"},[e._v("取消")])]):e._e(),e._v(" "),"text"==t.formType?a("x-input",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,title:t.displayName,placeholder:t.placeHolder},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[groupcont.tableName]"}}):e._e(),e._v(" "),"number"==t.formType?a("x-input",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,type:"number",title:t.displayName,placeholder:t.placeHolder}}):e._e(),e._v(" "),"datetime"==t.formType?a("datetime",{class:1==t.isNull?"red":"",attrs:{readonly:0==t.enabled,title:t.displayName,placeholder:t.placeHolder},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[groupcont.tableName]"}}):e._e(),e._v(" "),"textarea"==t.formType?a("x-textarea",{class:1==t.isNull?"red":"",attrs:{disabled:0==t.enabled,title:t.displayName,placeholder:t.placeHolder},model:{value:e.formSubmit[t.tableName],callback:function(a){e.$set(e.formSubmit,t.tableName,a)},expression:"formSubmit[groupcont.tableName]"}}):e._e()],1)}))],1)])})],2)])},staticRenderFns:[]};var l=a("C7Lr")(i,s,!1,function(e){a("0X4O")},null,null);t.a=l.exports},XTuI:function(e,t,a){"use strict";(function(e){var t=a("4YfN"),i=a.n(t),s=a("COCy");window.submifile=[];s.a,i()({},Vuex.mapState(["assetadd"])),i()({},Vuex.mapActions({assignment:"setAssetdate"}),{acceptImg:function(e){var t=e,a=this,i=t.files[0],s=t.files[0].type,l=(t.files[0].size/1024/1024).toFixed("3"),o=new FileReader;o.onload=function(e){compress(e.target.result,l,function(e){a.imageUrl=e,a.Img.data=e.replace("data:"+s+";base64,",""),a.Img.dataname=s})},o.readAsDataURL(i)},acceptFile:function(e){console.log(e),this.FileData=e;var t=this;t.filedataName=[],this.FileData.forEach(function(e,a){var i=e.name;t.filedataName.push(i);var s=new FileReader;s.readAsDataURL(e),s.onload=function(){var a=s.result.replace("data:"+e.type+";base64,","");t.filedata.push(a)}}),this.showfile=this.filedataName.join(","),console.log(this.filedataName),$("#fileshow").html(this.showfile)},reseat:function(t){var a=$("#Setfile");a.after(a.clone()),a.remove(),submifile=[],this.filedataName=[],this.filedata=[],this.showfile="",$("#fileshow").html(this.showfile),this.imageUrl=e.resUrl+"/Resources/images/nopicture.jpg",this.Img={data:"",dataname:""},0!=t&&this.getsubmitData()},submit:function(){var e=this;this.$http.post("/API/assetservice/SaveAsset",{"":{obj:this.formSubmit,mainAstId:"",Img:this.Img}},{emulateJSON:!0}).then(function(t){e.submitfile(t.data.resultNum)})},submitValidation:function(){for(var e=0,t=this.ValidationData,a=0;a<t.length;a++){var i=t[a];""!=this.formSubmit[i]&&e++}e==t.length?this.submit():this.$alert("请输入红色的必填项","提示",{confirmButtonText:"确定",callback:function(e){}})},submitfile:function(e){var t=this;this.$http.post("/API/assetservice/SaveFile",{"":{filedata:this.filedata,filedataName:this.filedataName,assetId:e}},{emulateJSON:!0}).then(function(e){t.$alert(e.data.resultMsg,"提示",{confirmButtonText:"确定",callback:function(e){}})})},getdata:function(){var e=this;this.$http.get("/API/assetservice/GetAssetPage",{parmas:{assetId:this.assetId}},{emulateJSON:!0}).then(function(t){e.AssetData=t.data,e.getValidationData(t.data),""==e.assetId?e.getsubmitData():e.GetAssetDetail()})},getsubmitData:function(){var e=this;this.$http.get("/API/assetservice/GetAddField",{emulateJSON:!0}).then(function(t){e.formSubmit=t.data,e.setVuex(vm.formSubmit)})},GetAssetDetail:function(){var t=this;this.$http.get("/API/assetservice/GetAssetDetail",{params:{assetId:this.assetId}},{emulateJSON:!0}).then(function(a){console.log(a.data),t.formSubmit=a.data.obj,null!=a.data.Img&&(t.imageUrl=e.resUrl+a.data.Img),t.showfile=a.data.File.fileName.join(","),$("#fileshow").html(t.showfile),t.setVuex(vm.formSubmit)})},setVuex:function(e){this.assignment(e)},getValidationData:function(e){for(var t in this.ValidationData=[],e)e[t].forEach(function(e){1==e.isNull&&this.ValidationData.push(e.tableName)},this)}})}).call(t,a("9AUj"))},Xjk3:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("XTuI");var i=a("6rPw"),s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"div1",staticStyle:{height:"100%",background:"white"}},[a("v-header",{attrs:{header:e.parentMsg}}),e._v(" "),a("builder",{staticStyle:{height:"80%"},attrs:{AssetData:e.AssetData,assetId:e.assetId,imageUrl:e.imageUrl,filedataName:e.filedataName,formSubmit:e.formSubmit,assetadd:e.assetadd},on:{acceptfile:e.acceptFile,accept:e.acceptImg}}),e._v(" "),a("div",{staticClass:"assetBottom"},[a("div",{on:{click:function(t){e.submitValidation()}}},[e._v("提交")]),e._v(" "),a("span",{staticClass:"verticalLines",attrs:{id:"vertical"}}),e._v(" "),a("div",{attrs:{id:"reset"},on:{click:function(t){e.reseat(1)}}},[e._v("重置")])])],1)},staticRenderFns:[]};var l=function(e){a("w2Ph")},o=a("C7Lr")(i.a,s,!1,l,null,null);t.default=o.exports},w2Ph:function(e,t){}});
//# sourceMappingURL=2.6a6ff3d7031a1f600be4.js.map